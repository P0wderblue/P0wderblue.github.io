<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SpringMVC源码阅读笔记 | P0wder_blue</title><meta name="author" content="LiangYutao"><meta name="copyright" content="LiangYutao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SpringMVC过程(这个是SpringMVC的全过程图片 有点太大了)初始化流程  第一步 首先是容器的创建 会创建三个容器 ServletContext：全局唯一，tomcat启动该web项目了创建 Spring的context：由servletcontext的监听器contextloaderlistener创建，默认读取servletcontext.xml配置，具体内容参考我们之前介绍的I">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringMVC源码阅读笔记">
<meta property="og:url" content="http://example.com/2023/10/07/SpringMVC%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="P0wder_blue">
<meta property="og:description" content="SpringMVC过程(这个是SpringMVC的全过程图片 有点太大了)初始化流程  第一步 首先是容器的创建 会创建三个容器 ServletContext：全局唯一，tomcat启动该web项目了创建 Spring的context：由servletcontext的监听器contextloaderlistener创建，默认读取servletcontext.xml配置，具体内容参考我们之前介绍的I">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/pics/1.jpg">
<meta property="article:published_time" content="2023-10-07T07:57:18.000Z">
<meta property="article:modified_time" content="2023-10-07T07:57:52.524Z">
<meta property="article:author" content="LiangYutao">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/pics/1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/10/07/SpringMVC%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: LiangYutao","link":"链接: ","source":"来源: P0wder_blue","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SpringMVC源码阅读笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-10-07 15:57:52'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/font.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/pics/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/pics/blogPic.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="P0wder_blue"><span class="site-name">P0wder_blue</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SpringMVC源码阅读笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-07T07:57:18.000Z" title="发表于 2023-10-07 15:57:18">2023-10-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-07T07:57:52.524Z" title="更新于 2023-10-07 15:57:52">2023-10-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java%E7%9B%B8%E5%85%B3/">Java相关</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SpringMVC源码阅读笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/typora/c27704fffe852fe1c79f7af533327da8.png">SpringMVC过程</a><br>(这个是SpringMVC的全过程图片 有点太大了)<br>初始化流程 </p>
<p>第一步 首先是容器的创建</p>
<p>会创建三个容器</p>
<p>ServletContext：全局唯一，tomcat启动该web项目了创建</p>
<p>Spring的context：由servletcontext的监听器contextloaderlistener创建，默认读取servletcontext.xml配置，具体内容参考我们之前介绍的IOC的源码实现。同时该cntext与servletcontext互相关联，该context被注册到servletcontext中以webapplicationcontext属性存在。</p>
<p>SpringMVC的context：SpringMVC初始化DispacherServlet时创建的上下文，该context为Spring的context的子容器，可以访问Spring容器中的内容（子容器可以访问父容器中的内容，但是反过来不行）。</p>
<p>第二步 DispatcherServlet的创建</p>
<ol>
<li>onRrefresh 会执行initStrategies去初始化九大组件</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onRefresh</span><span class="params">(ApplicationContext context)</span> &#123;</span><br><span class="line">	initStrategies(context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 初始化九大组件</span></span><br><span class="line">   <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initStrategies</span><span class="params">(ApplicationContext context)</span> &#123;</span><br><span class="line">       <span class="comment">//初始化文件上传解析对象组件MultipartResolver</span></span><br><span class="line">       <span class="comment">//该组件主要用于支持springMVC的文件上传</span></span><br><span class="line">       initMultipartResolver(context);</span><br><span class="line">       <span class="comment">//初始化国际化资源解析器LocaleResolver</span></span><br><span class="line">       initLocaleResolver(context);</span><br><span class="line">       <span class="comment">//初始化主题资源解析器 一个主题就是一组静态资源  其包含主题资源和主题解析器</span></span><br><span class="line">       initThemeResolver(context);</span><br><span class="line">       <span class="comment">//初始化处理器映射器 该组件主要是根据对应的请求 获取对应的处理逻辑组件Handler</span></span><br><span class="line">       <span class="comment">//（说白了就是我们编写的Controller的方法）</span></span><br><span class="line">       initHandlerMappings(context);</span><br><span class="line">       <span class="comment">//初始化处理器适配器，因为我们编写的Handler 可能是不同的了类型，比如简单类型，http类型等</span></span><br><span class="line">       <span class="comment">//为了使请求可能被不同的handler处理统一起来 这里会使用适配模式提供统一的处理请求的返回结果的接口</span></span><br><span class="line">       <span class="comment">//所有业务逻辑执行是在该处理器适配器中执行的</span></span><br><span class="line">       <span class="comment">//比如：我们国家的电压220V 但是和手机，洗衣机需要的电压，这里充电的时候会有不同的适配器将其电压转换为</span></span><br><span class="line">       <span class="comment">//合适终端的电压，此即为处理器适配器</span></span><br><span class="line">       initHandlerAdapters(context);</span><br><span class="line">       <span class="comment">//初始化 处理异常的组件，该组件有一个方法resolveException（） 该方法会对请求处理过程中出现异常的情况</span></span><br><span class="line">       <span class="comment">//进行处理 根据不同的异常返回不同的异常页面</span></span><br><span class="line">       initHandlerExceptionResolvers(context);</span><br><span class="line">       <span class="comment">//当Controller处理方法并没有返回视图的时候，且没有在reponse存放数据（往reponse中存放数据大多数是下载功能）</span></span><br><span class="line">       <span class="comment">//该组件按照其getViewName()设置视图 从而返回</span></span><br><span class="line">       initRequestToViewNameTranslator(context);</span><br><span class="line">       <span class="comment">//初始化视图解析器，当请求被处理放入ModelAndView.该组件会选择合适的视图去进行渲染</span></span><br><span class="line">       initViewResolvers(context);</span><br><span class="line">       <span class="comment">//初始化FlashMapManager 用于在重定向的时候 还能继续使用数据（一般情况重定向请求后请求参数会丢失）</span></span><br><span class="line">       initFlashMapManager(context);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在这里细看initHandlerMappings 这个方法会将容器中所有的HandlerMappings的Bean拿出来(Bean的初始化在容器创建(或者说Context创建的时候)已经完成了)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initHandlerMappings</span><span class="params">(ApplicationContext context)</span> &#123;</span><br><span class="line">	</span><br><span class="line">    <span class="built_in">this</span>.handlerMappings = <span class="literal">null</span>;</span><br><span class="line">	<span class="comment">// 是否查找所有HandlerMapping 默认为真</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.detectAllHandlerMappings) &#123;</span><br><span class="line">        <span class="comment">// 从容器中获取所有的Bean</span></span><br><span class="line">        Map&lt;String, HandlerMapping&gt; matchingBeans = BeanFactoryUtils.</span><br><span class="line">        beansOfTypeIncludingAncestors(context, HandlerMapping.class, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (!matchingBeans.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">// 将从容器中查找出来的HandlerMapping</span></span><br><span class="line">            <span class="comment">// 加入到DispatcherServlet的handlerMappings属性中</span></span><br><span class="line">            <span class="built_in">this</span>.handlerMappings = <span class="keyword">new</span> <span class="title class_">ArrayList</span>(matchingBeans.values());</span><br><span class="line">            AnnotationAwareOrderComparator.sort(<span class="built_in">this</span>.handlerMappings);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">HandlerMapping</span> <span class="variable">hm</span> <span class="operator">=</span> (HandlerMapping)context.getBean(<span class="string">&quot;handlerMapping&quot;</span>, HandlerMapping.class);</span><br><span class="line">            <span class="built_in">this</span>.handlerMappings = Collections.singletonList(hm);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchBeanDefinitionException var4) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.handlerMappings == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// 根据指定名称获取HandlerMapping对象</span></span><br><span class="line">        <span class="built_in">this</span>.handlerMappings = <span class="built_in">this</span>.getDefaultStrategies(context, HandlerMapping.class);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.logger.isTraceEnabled()) &#123;</span><br><span class="line">            <span class="built_in">this</span>.logger.trace(<span class="string">&quot;No HandlerMappings declared for servlet &#x27;&quot;</span> + <span class="built_in">this</span>.getServletName() + <span class="string">&quot;&#x27;: using default strategies from DispatcherServlet.properties&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Iterator</span> <span class="variable">var6</span> <span class="operator">=</span> <span class="built_in">this</span>.handlerMappings.iterator();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(var6.hasNext()) &#123;</span><br><span class="line">        <span class="type">HandlerMapping</span> <span class="variable">mapping</span> <span class="operator">=</span> (HandlerMapping)var6.next();</span><br><span class="line">        <span class="keyword">if</span> (mapping.usesPathPatterns()) &#123;</span><br><span class="line">            <span class="comment">// 设置是否为解析的RequestPath</span></span><br><span class="line">            <span class="built_in">this</span>.parseRequestPath = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来是initHandlerAdapters</p>
<p>initHandlerAdapters的过程和initHandlerMappings类似，<strong>也是先从上下文(包括所有父上下文)中查询类型为HandlerAdapter的Bean,并进行排序。如果为否，则从上下文中按指定名称去寻找。如果都没有找到，提供一个默认的实现。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initHandlerAdapters</span><span class="params">(ApplicationContext context)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.handlerAdapters = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.detectAllHandlerAdapters) &#123;</span><br><span class="line">        Map&lt;String, HandlerAdapter&gt; matchingBeans = BeanFactoryUtils.beansOfTypeIncludingAncestors(context, HandlerAdapter.class, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (!matchingBeans.isEmpty()) &#123;</span><br><span class="line">            <span class="built_in">this</span>.handlerAdapters = <span class="keyword">new</span> <span class="title class_">ArrayList</span>(matchingBeans.values());</span><br><span class="line">            AnnotationAwareOrderComparator.sort(<span class="built_in">this</span>.handlerAdapters);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">HandlerAdapter</span> <span class="variable">ha</span> <span class="operator">=</span> (HandlerAdapter)context.getBean(<span class="string">&quot;handlerAdapter&quot;</span>, HandlerAdapter.class);</span><br><span class="line">            <span class="built_in">this</span>.handlerAdapters = Collections.singletonList(ha);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchBeanDefinitionException var3) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.handlerAdapters == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.handlerAdapters = <span class="built_in">this</span>.getDefaultStrategies(context, HandlerAdapter.class);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.logger.isTraceEnabled()) &#123;</span><br><span class="line">            <span class="built_in">this</span>.logger.trace(<span class="string">&quot;No HandlerAdapters declared for servlet &#x27;&quot;</span> + <span class="built_in">this</span>.getServletName() + <span class="string">&quot;&#x27;: using default strategies from DispatcherServlet.properties&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HandlerAdapter处理器适配器用来执行Controller中的目标方法，由于上面有三种HandlerMapping，对应这里三种HandlerAdapter：</p>
<p>RequestMappingHandlerAdapter：对应RequestMappingHandlerMapping</p>
<p>HttpRequestHandlerAdapter：对应SimpleUrlHandlerMapping</p>
<p>SimpleControllerHandlerAdapter：对应BeanNameUrlHandlerMapping</p>
<p>额外补充：</p>
<p>Adapter这个东西 用的是适配器模式</p>
<p> 上一节中通过initHandlerMappings已经将request通过HandlerMapping(处理器映射器)将请求映射到了对应的Handler上，这一步就需要考虑如何解析并执行该handler对象。</p>
<pre><code>    这里Spring使用了适配器模式，主要是因为handler对象有两种不同的类型。

    （1）以实现了Controller接口的Handler类
</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoController</span> <span class="keyword">implements</span> <span class="title class_">Controller</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;进入DemoController方法执行处理逻辑&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;demo&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<pre><code>    （2）以@RequestMapping注解修饰的HandlerMethod对象
</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/book/ListPage&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getBookPage</span><span class="params">(<span class="meta">@RequestBody</span> BookQuery bookQuery)</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> success(pageTotal(pageInfo));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>   其他还有实现Servlet的实例，HandlerFunction实例、HttpRequestHandler实例等，不<strong>同的实例对象调用时走不同的方法，为了能将不同的方法转换成统一的调用形式，这里使用了适配器模式，将各个实例的方法调用包装到HandlerAdapter统一调用。</strong></p>
<p>HandlerAdapter的实现有以下几个</p>
<p><img src="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/typora/70bf77a47b8d1fd31b4c39323852bb60.png" alt="img"></p>
<p>而它的方法有</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 检查该Adapter是否支持该handler 实际实现就是</span></span><br><span class="line"><span class="comment">//看Handler的类型是不是Controller HandlerMethod 这类的bean</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(Object handler)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 适配器的handle方法 </span></span><br><span class="line"><span class="comment">// 默认调用的是handleInternal方法 然后在里面调用invokeHandlerMethod</span></span><br><span class="line"><span class="comment">// 从而获取ModeAndView</span></span><br><span class="line">   <span class="meta">@Nullable</span></span><br><span class="line">   ModelAndView <span class="title function_">handle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/** <span class="doctag">@deprecated</span> */</span></span><br><span class="line">   <span class="meta">@Deprecated</span></span><br><span class="line">   <span class="type">long</span> <span class="title function_">getLastModified</span><span class="params">(HttpServletRequest request, Object handler)</span>;</span><br></pre></td></tr></table></figure>

<p>invokeHandlerMethod方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">protected</span> ModelAndView <span class="title function_">invokeHandlerMethod</span><span class="params">(HttpServletRequest request, HttpServletResponse response, HandlerMethod handlerMethod)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ServletWebRequest</span> <span class="variable">webRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletWebRequest</span>(request, response);</span><br><span class="line"></span><br><span class="line">        ModelAndView var15;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">WebDataBinderFactory</span> <span class="variable">binderFactory</span> <span class="operator">=</span> <span class="built_in">this</span>.getDataBinderFactory(handlerMethod);</span><br><span class="line">            <span class="type">ModelFactory</span> <span class="variable">modelFactory</span> <span class="operator">=</span> <span class="built_in">this</span>.getModelFactory(handlerMethod, binderFactory);</span><br><span class="line">            <span class="type">ServletInvocableHandlerMethod</span> <span class="variable">invocableMethod</span> <span class="operator">=</span> <span class="built_in">this</span>.createInvocableHandlerMethod(handlerMethod);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.argumentResolvers != <span class="literal">null</span>) &#123;</span><br><span class="line">                invocableMethod.setHandlerMethodArgumentResolvers(<span class="built_in">this</span>.argumentResolvers);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.returnValueHandlers != <span class="literal">null</span>) &#123;</span><br><span class="line">                invocableMethod.setHandlerMethodReturnValueHandlers(<span class="built_in">this</span>.returnValueHandlers);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            invocableMethod.setDataBinderFactory(binderFactory);</span><br><span class="line">            invocableMethod.setParameterNameDiscoverer(<span class="built_in">this</span>.parameterNameDiscoverer);</span><br><span class="line">            <span class="type">ModelAndViewContainer</span> <span class="variable">mavContainer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndViewContainer</span>();</span><br><span class="line">            mavContainer.addAllAttributes(RequestContextUtils.getInputFlashMap(request));</span><br><span class="line">            modelFactory.initModel(webRequest, mavContainer, invocableMethod);</span><br><span class="line">            mavContainer.setIgnoreDefaultModelOnRedirect(<span class="built_in">this</span>.ignoreDefaultModelOnRedirect);</span><br><span class="line">            <span class="type">AsyncWebRequest</span> <span class="variable">asyncWebRequest</span> <span class="operator">=</span> WebAsyncUtils.createAsyncWebRequest(request, response);</span><br><span class="line">            asyncWebRequest.setTimeout(<span class="built_in">this</span>.asyncRequestTimeout);</span><br><span class="line">            <span class="type">WebAsyncManager</span> <span class="variable">asyncManager</span> <span class="operator">=</span> WebAsyncUtils.getAsyncManager(request);</span><br><span class="line">            <span class="comment">// 设置异步的TaskExecutor和AsyncWebRequest</span></span><br><span class="line">            asyncManager.setTaskExecutor(<span class="built_in">this</span>.taskExecutor);</span><br><span class="line">            asyncManager.setAsyncWebRequest(asyncWebRequest);</span><br><span class="line">            <span class="comment">//注册可调用拦截器和延迟结果拦截器。</span></span><br><span class="line">            asyncManager.registerCallableInterceptors(<span class="built_in">this</span>.callableInterceptors);</span><br><span class="line">            asyncManager.registerDeferredResultInterceptors(<span class="built_in">this</span>.deferredResultInterceptors);</span><br><span class="line">            Object result;</span><br><span class="line">            <span class="comment">//异步请求是否已经完成</span></span><br><span class="line">            <span class="comment">//如果为true已经解析出结果，发生在该请求接口执行完后的第二次请求结果，获取执行结果</span></span><br><span class="line">            <span class="keyword">if</span> (asyncManager.hasConcurrentResult()) &#123;</span><br><span class="line">                 <span class="comment">//如果异步请求已经处理完成，则获取执行结果  --- 1</span></span><br><span class="line">                result = asyncManager.getConcurrentResult();</span><br><span class="line">                <span class="comment">// 获取并清除异步结果。</span></span><br><span class="line">                mavContainer = (ModelAndViewContainer)asyncManager.getConcurrentResultContext()[<span class="number">0</span>];</span><br><span class="line">                asyncManager.clearConcurrentResult();</span><br><span class="line">                LogFormatUtils.traceDebug(<span class="built_in">this</span>.logger, (traceOn) -&gt; &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">formatted</span> <span class="operator">=</span> LogFormatUtils.formatValue(result, !traceOn);</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;Resume with async result [&quot;</span> + formatted + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// 将异步结果封装起来 实际上就是保存了result和returnType</span></span><br><span class="line">                <span class="comment">//覆盖原有的requestMappingMethod方法;  --- 2</span></span><br><span class="line">                invocableMethod = invocableMethod.wrapConcurrentResult(result);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//执行方法 -- 3</span></span><br><span class="line"></span><br><span class="line">            </span><br><span class="line"><span class="comment">//             springMVC异步处理请求的过程是总体上可以拆分为2次：</span></span><br><span class="line"><span class="comment">// 第一次，启动异步请求，并设置timeout,completion等事件的监听，直接返回 null;</span></span><br><span class="line"><span class="comment">// 第二次，当监听到completion 时，直接在发送一次相同的请求，并将执行结果返回。</span></span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">            invocableMethod.invokeAndHandle(webRequest, mavContainer, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]);</span><br><span class="line">           <span class="comment">//asyncManager是否已经启动</span></span><br><span class="line">            <span class="keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;</span><br><span class="line">                  <span class="comment">//-- 4 返回null</span></span><br><span class="line">                result = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">return</span> (ModelAndView)result;</span><br><span class="line">            &#125;</span><br><span class="line">        	<span class="comment">// --- 5</span></span><br><span class="line">            var15 = <span class="built_in">this</span>.getModelAndView(mavContainer, modelFactory, webRequest);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            webRequest.requestCompleted();</span><br><span class="line">        &#125;</span><br><span class="line">    	<span class="comment">// 返回modelAndView</span></span><br><span class="line">        <span class="keyword">return</span> var15;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>在这个方法中 求是是先设置好了ModelAndView的Contasiner 还有ModelFactory</p>
<p>异步请求那块可以看这个</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deityjian/p/11503218.html">异步请求</a></p>
<p>对于异步请求那块的if</p>
<ul>
<li>第一次执行时： 会执行上述代码中的 3,4</li>
<li>第二次执行时： 执行上述代码中的1,2,3,5 。 注意步骤2,会将原有的requestMappingMethod重写.接下来会分析。</li>
</ul>
<p>handlerAdater.handle 的调用链是这样的</p>
<p>handle()-&gt; handleInternal()-&gt;invokeHandlerMethod()-&gt;invokeAndHandle()</p>
<p>在invokeAndHandle的时候 实际上是将ModelAndViewContainer传参进去进行获取</p>
<p>然后调用 getModelAndView(mavContainer, modelFactory, webRequest)去进行ModelAndView的获取 这个方法就会构造出从方法获取的ModelAndView </p>
<p>对于invokeAndHandle() 这里 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invokeAndHandle</span><span class="params">(ServletWebRequest webRequest, ModelAndViewContainer mavContainer, Object... providedArgs)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">     <span class="type">Object</span> <span class="variable">returnValue</span> <span class="operator">=</span> <span class="built_in">this</span>.invokeForRequest(webRequest, mavContainer, providedArgs);</span><br><span class="line">     <span class="built_in">this</span>.setResponseStatus(webRequest);</span><br><span class="line">     <span class="keyword">if</span> (returnValue == <span class="literal">null</span>) &#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="built_in">this</span>.isRequestNotModified(webRequest) || <span class="built_in">this</span>.getResponseStatus() != <span class="literal">null</span> || mavContainer.isRequestHandled()) &#123;</span><br><span class="line">             <span class="built_in">this</span>.disableContentCachingIfNecessary(webRequest);</span><br><span class="line">             mavContainer.setRequestHandled(<span class="literal">true</span>);</span><br><span class="line">             <span class="keyword">return</span>;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (StringUtils.hasText(<span class="built_in">this</span>.getResponseStatusReason())) &#123;</span><br><span class="line">         mavContainer.setRequestHandled(<span class="literal">true</span>);</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     mavContainer.setRequestHandled(<span class="literal">false</span>);</span><br><span class="line">     Assert.state(<span class="built_in">this</span>.returnValueHandlers != <span class="literal">null</span>, <span class="string">&quot;No return value handlers&quot;</span>);</span><br><span class="line"></span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="built_in">this</span>.returnValueHandlers.handleReturnValue(returnValue, <span class="built_in">this</span>.getReturnValueType(returnValue), mavContainer, webRequest);</span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception var6) &#123;</span><br><span class="line">         <span class="keyword">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class="line">             logger.trace(<span class="built_in">this</span>.formatErrorForReturnValue(returnValue), var6);</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">throw</span> var6;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>方法第一步就是进行request的调用 来获取返回值 后面的操作都是对returnValue进行处理</p>
<p>在invokeForRequest中 实际上是现货区ArgumentValues 然后调用doInvoke来调用方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invokeForRequest</span><span class="params">(NativeWebRequest request, <span class="meta">@Nullable</span> ModelAndViewContainer mavContainer, Object... providedArgs)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Object[] args = <span class="built_in">this</span>.getMethodArgumentValues(request, mavContainer, providedArgs);</span><br><span class="line">        <span class="keyword">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class="line">            logger.trace(<span class="string">&quot;Arguments: &quot;</span> + Arrays.toString(args));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.doInvoke(args);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 这个方法是HandleMethod的方法 因此 这个HandleMethod其实是包装过的Controller中的方法</span></span><br><span class="line"><span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">doInvoke</span><span class="params">(Object... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 因为方法可能是代理机制包装的 所以用getBridgedMethod来获取原始方法</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> <span class="built_in">this</span>.getBridgedMethod();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 在这里调用 反射调用方法</span></span><br><span class="line">            <span class="keyword">return</span> KotlinDetector.isSuspendingFunction(method) ? CoroutinesUtils.invokeSuspendingFunction(method, <span class="built_in">this</span>.getBean(), args) : method.invoke(<span class="built_in">this</span>.getBean(), args);</span><br><span class="line">            <span class="comment">// 下面那堆exception没必要看</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalArgumentException var5 ) &#123;</span><br><span class="line">            <span class="built_in">this</span>.assertTargetBean(method, <span class="built_in">this</span>.getBean(), args);</span><br><span class="line">            <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> var5.getMessage() != <span class="literal">null</span> ? var5.getMessage() : <span class="string">&quot;Illegal argument&quot;</span>;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="built_in">this</span>.formatInvokeError(text, args), var5);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException var6) &#123;</span><br><span class="line">            <span class="type">Throwable</span> <span class="variable">targetException</span> <span class="operator">=</span> var6.getTargetException();</span><br><span class="line">            <span class="keyword">if</span> (targetException <span class="keyword">instanceof</span> RuntimeException) &#123;</span><br><span class="line">                <span class="keyword">throw</span> (RuntimeException)targetException;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (targetException <span class="keyword">instanceof</span> Error) &#123;</span><br><span class="line">                <span class="keyword">throw</span> (Error)targetException;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (targetException <span class="keyword">instanceof</span> Exception) &#123;</span><br><span class="line">                <span class="keyword">throw</span> (Exception)targetException;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="built_in">this</span>.formatInvokeError(<span class="string">&quot;Invocation failure&quot;</span>, args), targetException);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">LiangYutao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2023/10/07/SpringMVC%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">http://example.com/2023/10/07/SpringMVC%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">P0wder_blue</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Spring/">Spring</a></div><div class="post_share"><div class="social-share" data-image="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/pics/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/typora/image-20231007105925450.png" target="_blank"><img class="post-qr-code-img" src="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/typora/image-20231007105925450.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/typora/image-20231007105915943.png" target="_blank"><img class="post-qr-code-img" src="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/typora/image-20231007105915943.png" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/07/MySql/" title="MySql"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySql</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/07/QUIC%E4%BB%8B%E7%BB%8D/" title="QUIC介绍"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">QUIC介绍</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://pobl-image-oss.oss-cn-heyuan.aliyuncs.com/pics/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">LiangYutao</div><div class="author-info__description">l'impossibilité d'aimer dans notre temps. </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://music.163.com/#/user/home?id=438480638"><i class="iconfont icon-wangyiyunyinle"></i><span>My NetEase</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Not Ready Yet</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/10/07/Apollo%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/" title="Apollo配置中心">Apollo配置中心</a><time datetime="2023-10-07T08:00:46.000Z" title="发表于 2023-10-07 16:00:46">2023-10-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/10/07/MySql/" title="MySql">MySql</a><time datetime="2023-10-07T07:59:34.000Z" title="发表于 2023-10-07 15:59:34">2023-10-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/10/07/SpringMVC%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" title="SpringMVC源码阅读笔记">SpringMVC源码阅读笔记</a><time datetime="2023-10-07T07:57:18.000Z" title="发表于 2023-10-07 15:57:18">2023-10-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/10/07/QUIC%E4%BB%8B%E7%BB%8D/" title="QUIC介绍">QUIC介绍</a><time datetime="2023-10-07T07:54:39.000Z" title="发表于 2023-10-07 15:54:39">2023-10-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/10/07/TCP-IP/" title="TCP/IP">TCP/IP</a><time datetime="2023-10-07T05:15:37.000Z" title="发表于 2023-10-07 13:15:37">2023-10-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By LiangYutao</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>